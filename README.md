# RepairHub - фінальний проєкт FastAPI

## Налаштування бази даних за допомогою Alembic

Щоб налаштувати базу даних з усіма необхідними таблицями, виконайте такі кроки:

### Початкове налаштування

1. Переконайтеся, що у вас встановлені всі залежності:
   ```
   pip install -r requirements.txt
   ```

2. Налаштуйте змінні середовища у файлі `.env` (скопіюйте з `sample.env`, якщо потрібно).

### Створення/Міграція бази даних

Схема бази даних керується за допомогою міграцій Alembic. Щоб створити або оновити схему бази даних:

1. **Застосуйте всі міграції** (це створить/оновить усі таблиці):
   ```
   alembic upgrade head
   ```

2. **Альтернативний метод** з використанням нашого допоміжного скрипту:
   ```
   python create_db.py
   ```

### Додавання тестових даних

Після налаштування схеми бази даних можна заповнити її тестовими даними:

```
python mock_data.py
```

Це додасть такі дані:
- Адміністративний користувач (admin@example.com / admin123)
- Звичайний користувач (user@example.com / user123)
- Зразки продуктів у різних категоріях

### Створення нових міграцій

Коли ви вносите зміни в моделі SQLAlchemy у файлі `models/models.py`:

1. **Генерація нової міграції**:
   ```
   alembic revision --autogenerate -m "Description of changes"
   ```

2. **Перегляньте згенерований файл міграції** у розділі `migrations/versions/`.

3. **Застосуйте міграцію**:
   ```
   alembic upgrade head
   ```

### Перевірка статусу міграції

- Перевірте поточну версію бази даних:
  ```
  alembic current
  ```

- Перевірте доступні версії:
  ```
  alembic heads
  ```

### Поширені проблеми

1. **Якщо у вас є помилки «таблиця вже існує»**, можливо, доведеться поставити штамп у базу даних:
   ```
   alembic stamp head
   ```

2. **SQLite не підтримує всі операції**: Деякі міграції можуть завершуватися невдачею, оскільки SQLite не підтримує операції типу `ALTER COLUMN`. У цих випадках файли міграції потрібно коригувати вручну для сумісності з SQLite.

3. **Щоб повністю скинути міграції**:
   - Видалити файл бази даних (`repairhub.db`)
   - Видалити всі файли в `migrations/versions/` 
   - Створіть нові міграції або відновіть їх із контролю версій

## Початок роботи з додатком

Щоб запустити додаток FastAPI:

```
uvicorn main:app --reload
```

Або просто:

```
python main.py
```